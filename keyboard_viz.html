<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
    rect.bordered {
        stroke: #E6E6E6;
        stroke-width:4px;   
      }
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
  </style>
</head>

<body>
  <script>
    var margin = { top: 50, right: 0, bottom: 50, left: 30 },
          width = window.innerWidth - margin.left - margin.right,
          height = window.innerHeight - margin.top - margin.bottom;

    var svg = d3.select("body").append("svg")
          .attr("width", width)
          .attr("height", height);
          //.append("g")
          //.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
    
    var data;
    var height2 = width / 3;
    
    d3.json('keyboard_display.json', function(json) {
      data = json;
      console.log(data);
      svg.selectAll("rect").data(data).enter()
      	.append("rect")
        .attr("x", function(d,i) {return width*d.start;})
        .attr("y", function(d,i) {return height2*d.nb/5;})
        .attr("width", function(d,i) {return  width*d.rat;})
        .attr("height", function(d,i) {return height2/5;})
        .attr("fill", function(d,i) {return "grey";})
      	//.attr("stroke-width", 6)
      	//.attr("stroke", "white")
      	.attr("rx", 0)
        .attr("ry", 0)
        .attr("class", "hour bordered")
      
      svg.selectAll("text").data(data).enter()
      	.append("text")
      	.attr("y", function(d) {return height2*d.nb/5 + height2/10;})
      	.attr("x", function(d) {return width*(d.start + d.rat/2);})
      	.attr("font-size", 17)
      	.attr("font-family", "monospace")
      	.text(function(d) {return d.v})
      	.attr("fill", "white")
      	.attr("text-anchor", "middle")
    })
    
  </script>
</body>