<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="width=device-width,initial-scale=1" name="viewport">
	<meta content="description" name="description">
	<meta name="google" content="notranslate" />
	<meta content="Mashup templates have been developped by Orson.io team" name="author">
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="functions/barchart_right.js"></script>
	<script src="functions/barchart_left.js"></script>
	<script src="functions/stroke2freq.js"></script>
	<script src="functions/data_filter.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<style>
		body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0;}
	</style>

	<meta name="msapplication-tap-highlight" content="no">
	
	<link rel="apple-touch-icon" sizes="180x180" href="./assets/apple-icon-180x180.png">
	<link href="./assets/apple-icon-180x180.ico" rel="icon">

	<title>KeysViz Project</title>  

	<link href="./main.3f6952e4.css" rel="stylesheet">
</head>

<body>
<header>
	<nav class="navbar  navbar-fixed-top navbar-default">
		<div class="container">
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav ">
					<li><a href="./index.html" title="">01 : Home</a></li>
					<li><a href="./keyboard_viz.html" title="">02 : Visualizations</a></li>
					<li><a href="./about.html" title="">03 : About the project</a></li>
				</ul>
			</div> 
		</div>
	</nav>
</header>

<div style="margin-top:10px">

	<form id="form" align="right" position="relative">

		<div>
			<span><a href="./keyboard_viz.html" class="btn btn-default">Keyboard</a></span>
			<span><a href="./viz.html" class="btn btn-default">Barcharts</a></span>
			<span><a href="./Chords_viz.html" class="btn btn-default">Chords Diagram</a></span>
			<span>&ensp;</span>
		</div>


		<div style="margin-top:15px">

			<span>&ensp;</span>

			<span>
				<select id="barchart1">
					<option value="d3" rel="icon-temperature">D3 coding</option>
					<option value="philosophy">Philosophy paper</option>
					<option value="matlab">Matlab coding</option>
					<option value="mail">Mail</option>
					<option value="scientifical">Scientifical paper</option>
				</select> 
			</span>

			<span>
				<select id="barchart2">
					<option value="d3" rel="icon-temperature">D3 coding</option>
					<option value="philosophy" selected>Philosophy paper</option>
					<option value="matlab">Matlab coding</option>
					<option value="mail">Mail</option>
					<option value="scientifical">Scientifical paper</option>
				</select> 
			</span>

			&nbsp;Sorting by :
			<label><input type="radio" name="layout" value="descending" checked> Frequency&nbsp;</label>
			<label><input type="radio" name="layout" value="alphabetical"> Alphabetical &nbsp;</label>
		</div>
	</form>

	

	<script>

		var topHeight = Math.max(document.getElementById("navbar-collapse").offsetHeight,document.getElementById("form").offsetHeight);
		var outerWidth = $(window).width();//window.innerWidth
		var screen_w = screen.width;
		var ratio_w = outerWidth/screen_w;
		var outerHeight = $(window).height()-topHeight;
		var screen_h = screen.height;
		var ratio_h = outerHeight/screen_h;
		var ratio = Math.min(ratio_h, ratio_w);
		var margin = {top: 0.04*outerWidth, right: 0.06*outerWidth, bottom:0.04*outerWidth, left: 0.06*outerWidth};

		var innerWidth = outerWidth/2 - margin.left - margin.right;
		var innerHeight = outerHeight - margin.top - margin.bottom;
		var alpha = false;
		//Create the SVG


		//var parseDate = d3.timeParse("%Y-%m-%d %H:%M:%S,%L");
		//var displayDate = d3.timeFormat("%Y-%m-%d %H:%M:%S,%L");

		function plot(alph, main_key_left="d3", main_key_right="philosophy"){
			
			if (d3.select("svg").empty()){
			var svg = d3.select("body").append("svg")
				.attr("id","svg_id")
				.attr("width", outerWidth)
				.attr("height", outerHeight);

			}else{
				var svg = d3.select("#svg_id")
			}


            data_path = 'https://raw.githubusercontent.com/Tridet/KeysViz/master/data.json'
			d3.json(data_path, function(json){
					var data = json;
					var filter_count = 30;
					var w = innerWidth;
					var h = innerHeight;
					var color = 'salmon';
					var alphabetical = alph;
					
					if (d3.select("#"+main_key_left).empty()){
						var g = svg.append("g")
							.attr("transform", "translate(" + margin.right*0.6 + "," + (margin.top*0.8) + ")");
						barchart_left(g, data, main_key_left, filter_count, w, h, ratio, color, alphabetical);
						g.attr("id","#" + main_key_left)
				}
					//d3.select("input[value=\"descending\"]").on("click", barchart_left(g, data, 30, innerWidth, innerHeight, "salmon",false));
					//d3.select("input[value=\"alphabetical\"]").on("click", barchart_left(g, data, 30, innerWidth, innerHeight, "salmon",true));

					if (d3.select("#"+main_key_right).empty()){
						var g1 = svg.append("g")
							.attr("transform", "translate(" + (outerWidth/2 + margin.left) + "," +  (margin.top*0.8) + ")");
						barchart_right(g1, data, main_key_right, filter_count, w, h, ratio, color, alphabetical);
						g1.attr("id","#" + main_key_right)
				}
					//d3.select("input[value=\"descending\"]").on("click", barchart_left(g, data, 30, innerWidth, innerHeight, "salmon",false));
					//d3.select("input[value=\"alphabetical\"]").on("click", barchart_left(g, data, 30, innerWidth, innerHeight, "salmon",true));
			});
		}

		d3.select("#barchart1")
			.on("change",function(){
				var val = this.value;
				var old_val = d3.select("#barchart2").property("value");
				d3.select("#svg_id").remove();
				console.log(alpha)
				plot(alpha, val, old_val)
			})

		d3.select("#barchart2")
			.on("change",function(){
				var val = this.value;
				var old_val = d3.select("#barchart1").property("value");
				d3.select("#svg_id").remove();
				plot(alpha, old_val, val)
			})

		d3.select("input[value=\"descending\"]").on("click", function(){
			d3.select("#svg_id").remove();
			alpha = false;
			plot(alpha, d3.select("#barchart1").value, d3.select("#barchart2").value );});

		d3.select("input[value=\"alphabetical\"]").on("click",  function(){
			d3.select("#svg_id").remove();
			alpha = true;
			plot(alpha, d3.select("#barchart1").value, d3.select("#barchart2").value );});

		plot(false, "d3", "philosophy");

	</script>
</div>

<script>
	document.addEventListener("DOMContentLoaded", function (event) {
		 navActivePage();
	});
</script>
<script type="text/javascript" src="./main.70a66962.js"></script></body>
</body>
</html>
